import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

# Step 1 - add your SMTP server settings
smtp_server = 'smtp.gmail.com'
smtp_port = 587
smtp_username = 'your-smtp-username@gmail.com'
smtp_password = 'password-here'

# Step 2 add your recipeint email - works well for ticket systems or Teams / Slack channels
message = MIMEMultipart()
message['From'] = 'Flaming CVE Reader'
message['To'] = 'alert-email@example.com'
message['Subject'] = 'CVE Numbers Found in Security Blogs'

# Read text file and add contents to email body
with open('/var/output.txt', 'r') as file:
    body = file.read()

# Step 3 Amend the Link to your security product or Standard Operating Procedure
html = f"""\
<html>
  <body>
    <p>To Threat Hunt  <a href="https://example.com/LinkToYourSecurityProduct">click here</a></p>
    <p>{body}</p>
  </body>
</html>
"""

# Attach the HTML message body to the email message
message.attach(MIMEText(html, 'html'))

# Connect to SMTP server and send email
with smtplib.SMTP(smtp_server, smtp_port) as smtp:
    smtp.starttls()
    smtp.login(smtp_username, smtp_password)
    smtp.sendmail(message['From'], message['To'], message.as_string())
    print('Email sent successfully')
